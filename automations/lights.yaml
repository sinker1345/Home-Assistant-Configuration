  - alias: 'turn on bar light with morning automation'
    trigger:
      - platform: state
        entity_id: switch.morning_alert
        from: 'off'
        to: 'on'
    action:
      - service: light.turn_on
        entity_id: light.bar_light
        data:
          brightness_pct: 30

  - alias: 'turn off bar light at night'
    trigger:
      - platform: state
        entity_id: sensor.common_area_motion
        to: 'Standby'
        for:
          minutes: 30
    condition:
      condition: and
      conditions:
        - condition: time
          after: '20:30:00'
          before: '05:30:00'
        - condition: or
          conditions:
            - condition: state
              entity_id: group.jessica
              state: home
            - condition: state
              entity_id: group.tommy
              state: home
    action:
      - service: light.turn_off
        entity_id: light.bar_light


  - alias: 'turn on bar light at night'
    trigger:
      - platform: state
        entity_id: sensor.common_area_motion
        to: 'Motion Detected'
    condition:
      condition: and
      conditions:
        - condition: time
          after: '20:30:00'
          before: '05:30:00'
        - condition: state
          entity_id: light.bar_light
          state: 'off'
        - condition: or
          conditions:
            - condition: state
              entity_id: group.jessica
              state: home
            - condition: state
              entity_id: group.tommy
              state: home
    action:
      - service: light.turn_on
        entity_id: light.bar_light
        data:
          brightness_pct: 30

  - alias: 'turn on bar light When people arrive home after dark'
    trigger:
      - platform: state
        entity_id: sensor.jessica_status
        from: 'Away'
        to: 'Just Arrived'
      - platform: state
        entity_id: sensor.tommy_status
        from: 'Away'
        to: 'Just Arrived'
      - platform: state
        entity_id: sensor.jessica_status
        from: 'Extended Away'
        to: 'Just Arrived'
      - platform: state
        entity_id: sensor.tommy_status
        from: 'Extended Away'
        to: 'Just Arrived'
    condition:
      condition: and
      conditions:
        - condition: sun
          after: sunset
        - condition: state
          entity_id: light.bar_light
          state: 'off'
    action:
      - service: light.turn_on
        entity_id: light.bar_light
        data:
          brightness_pct: 100

  - alias: 'turn off bar light When people leave'
    trigger:
      - platform: state
        entity_id: sensor.jessica_status
        from: 'Just Left'
        to: 'Away'
      - platform: state
        entity_id: sensor.tommy_status
        from: 'Just Left'
        to: 'Away'
    condition:
      condition: and
      conditions:
        - condition: state
          entity_id: light.bar_light
          state: 'on'
        - condition: state
          entity_id: sensor.jessica_status
          state: 'Away'
        - condition: state
          entity_id: sensor.tommy_status
          state: 'Away'
    action:
      - service: light.turn_off
        entity_id: light.bar_light

